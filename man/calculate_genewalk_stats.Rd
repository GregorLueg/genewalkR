% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genewalk.R
\name{calculate_genewalk_stats}
\alias{calculate_genewalk_stats}
\title{Calculate the pathway and gene statistics}
\usage{
calculate_genewalk_stats(object, .verbose = TRUE)
}
\arguments{
\item{object}{The \code{GeneWalk} object containing actual and permuted
embeddings. See \code{\link[=GeneWalk]{GeneWalk()}}.}

\item{.verbose}{Logical. If \code{TRUE}, prints progress messages during
calculation. Default is \code{TRUE}.}
}
\value{
The input object with an added \code{stats} property containing a
data.table with the following columns for each gene-pathway pair:
\itemize{
\item gene - Gene identifier
\item pathway - Pathway identifier
\item avg_pval - Mean p-value across permutations
\item pval_ci_lower, pval_ci_upper - 95\% CI for p-values
\item avg_global_fdr - Mean global FDR across permutations
\item global_fdr_ci_lower,global_fdr_ci_upper - 95\% CI for global FDR
\item avg_gene_fdr - Mean gene-wise FDR across permutations
\item gene_fdr_ci_lower,gene_fdr_ci_upper - 95\% CI for gene-wise FDR
}
}
\description{
Calculates statistical significance for gene-pathway associations using
the GeneWalk algorithm. For each gene-pathway pair, this function computes
p-values and FDR corrections (both globally across all pairs and per-gene)
across multiple network permutations. The final output includes mean values
and 95\% confidence intervals for all statistics.

The function processes all permutations in Rust for optimal performance,
calculating cosine similarities between gene and pathway embeddings,
determining p-values based on null distributions from randomised networks,
and applying Benjamini-Hochberg FDR corrections.
}
\references{
Ietswaart, et al., Genome Biol, 2021
}
